Imports System.IO
Imports System.Text.RegularExpressions
Module Test_regularExpression
#Region "  - Filenames -  文件名列表"
        Private Filenames As String() = { _
            "测斜报表-001-2012-11-13.xls",
            "测斜报表-002-2012-11-14.xls",
            "测斜报表-003-2012-11-15.xls",
            "测斜报表-004-2012-11-16.xls",
            "测斜报表-005-2012-11-17.xls",
            "测斜报表-006-2012-11-18.xls",
            "测斜报表-007-2012-11-19.xls",
            "测斜报表-008-2012-11-20.xls",
            "测斜报表-009-2012-11-22.xls",
            "测斜报表-010-2012-11-23.xls",
            "测斜报表-011-2012-11-24.xls",
            "测斜报表-012-2012-11-25.xls",
            "测斜报表-013-2012-11-26.xls",
            "测斜报表-014-2012-11-27.xls",
            "测斜报表-015-2012-11-28.xls",
            "测斜报表-016-2012-11-29.xls",
            "测斜报表-017-2012-11-30.xls",
            "测斜报表-018-2012-12-01.xls",
            "测斜报表-019-2012-12-02.xls",
            "测斜报表-020-2012-12-03.xls",
            "测斜报表-021-2012-12-04.xls",
            "测斜报表-022-2012-12-05.xls",
            "测斜报表-023-2012-12-06.xls",
            "测斜报表-024-2012-12-07.xls",
            "测斜报表-025-2012-12-08.xls",
            "测斜报表-026-2012-12-09.xls",
            "测斜报表-027-2012-12-10.xls",
            "测斜报表-028-2012-12-11.xls",
            "测斜报表-029-2012-12-12.xls",
            "测斜报表-030-2012-12-13.xls",
            "测斜报表-031-2012-12-14.xls",
            "测斜报表-032-2012-12-15.xls",
            "测斜报表-033-2012-12-16.xls",
            "测斜报表-034-2012-12-17.xls",
            "测斜报表-035-2012-12-18.xls",
            "测斜报表-036-2012-12-19.xls",
            "测斜报表-037-2012-12-20.xls",
            "测斜报表-038-2012-12-21.xls",
            "测斜报表-039-2012-12-22.xls",
            "测斜报表-040-2012-12-23.xls",
            "测斜报表-041-2012-12-24.xls",
            "测斜报表-042-2012-12-25.xls",
            "测斜报表-043-2012-12-26.xls",
            "测斜报表-044-2012-12-27.xls",
            "测斜报表-045-2012-12-28.xls",
            "测斜报表-046-2012-12-29.xls",
            "测斜报表-047-2012-12-30.xls",
            "测斜报表-048-2012-12-31.xls",
            "测斜报表-049-2013-01-01.xls",
            "测斜报表-050-2013-01-02.xls",
            "测斜报表-051-2013-01-03.xls",
            "测斜报表-052-2013-01-04.xls",
            "测斜报表-053-2013-01-05.xls",
            "测斜报表-054-2013-01-06.xls",
            "测斜报表-055-2013-01-07.xls",
            "测斜报表-056-2013-01-08.xls",
            "测斜报表-057-2013-01-09.xls",
            "测斜报表-058-2013-01-10.xls",
            "测斜报表-059-2013-01-11.xls",
            "测斜报表-060-2013-01-12.xls",
            "测斜报表-061-2013-01-13.xls",
            "测斜报表-062-2013-01-14.xls",
            "测斜报表-063-2013-01-15.xls",
            "测斜报表-064-2013-01-16.xls",
            "测斜报表-065-2013-01-17.xls",
            "测斜报表-066-2013-01-18.xls",
            "测斜报表-067-2013-01-19.xls",
            "测斜报表-068-2013-01-20.xls",
            "测斜报表-069-2013-01-21.xls",
            "测斜报表-070-2013-01-22.xls",
            "测斜报表-071-2013-01-23.xls",
            "测斜报表-072-2013-01-24.xls",
            "测斜报表-073-2013-01-25.xls",
            "测斜报表-074-2013-01-26.xls",
            "测斜报表-075-2013-01-27.xls",
            "测斜报表-076-2013-01-28.xls",
            "测斜报表-077-2013-01-29.xls",
            "测斜报表-078-2013-01-30.xls",
            "测斜报表-079-2013-02-01.xls",
            "测斜报表-080-2013-02-03.xls",
            "测斜报表-081-2013-02-05.xls",
            "测斜报表-082-2013-02-08.xls",
            "测斜报表-083-2013-02-17.xls",
            "测斜报表-084-2013-02-21.xls",
            "测斜报表-085-2013-02-22.xls",
            "测斜报表-086-2013-02-23.xls",
            "测斜报表-087-2013-02-24.xls",
            "测斜报表-088-2013-02-25.xls",
            "测斜报表-089-2013-02-26.xls",
            "测斜报表-090-2013-02-27.xls",
            "测斜报表-091-2013-02-28.xls",
            "测斜报表-092-2013-03-01.xls",
            "测斜报表-093-2013-03-02.xls",
            "测斜报表-094-2013-03-03.xls",
            "测斜报表-095-2013-03-11.xls",
            "测斜报表-096-2013-03-18.xls",
            "测斜报表-097-2013-03-27.xls",
            "测斜报表-098-2013-03-28.xls",
            "测斜报表-099-2013-03-30.xls",
            "测斜报表-100-2013-03-31.xls",
            "测斜报表-101-2013-04-01.xls",
            "测斜报表-102-2013-04-02.xls",
            "测斜报表-103-2013-04-03.xls",
            "测斜报表-104-2013-04-04.xls",
            "测斜报表-105-2013-04-05.xls",
            "测斜报表-106-2013-04-06.xls",
            "测斜报表-107-2013-04-08.xls",
            "测斜报表-108-2013-04-09.xls",
            "测斜报表-109-2013-04-10.xls",
            "测斜报表-110-2013-04-17.xls",
            "测斜报表-111-2013-04-24.xls",
            "测斜报表-112-2013-04-26.xls",
            "测斜报表-113-2013-04-27.xls",
            "测斜报表-114-2013-04-28.xls",
            "测斜报表-115-2013-04-29.xls",
            "测斜报表-116-2013-05-01.xls",
            "测斜报表-117-2013-05-02.xls",
            "测斜报表-118-2013-05-03.xls",
            "测斜报表-119-2013-05-04.xls",
            "测斜报表-120-2013-05-05.xls",
            "测斜报表-121-2013-05-06.xls",
            "测斜报表-122-2013-05-07.xls",
            "测斜报表-123-2013-05-08.xls",
            "测斜报表-124-2013-05-09.xls",
            "测斜报表-125-2013-05-10.xls",
            "测斜报表-126-2013-05-11.xls",
            "测斜报表-127-2013-05-13.xls",
            "测斜报表-128-2013-05-14.xls",
            "测斜报表-129-2013-05-15.xls"}
#End Region
        Private DirectorName = "F:\基坑数据\1_ 监测资料与地勘报告\B03-A1\03A监测报表\测斜-商飞"
        Sub Main()
            Dim fn As String = Filenames(0)   ' "测斜报表-001-2012-11-13.xls"
            fn = "测斜报表-001-2012-11-13.xls"
        fn = "测斜报表- 001-  2012 -11-  13  .xls"
        Dim pattern As String = "报表-\s*(\d{3})\s*-\s*(\d{4})\s*-\s*(\d{2})\s*-\s*(\d{2})\s*"
        pattern = "测斜报表-\s*(\d{3})\s*-\s*(\d{4})\s*-\s*(\d{2})\s*-\s*(\d{2})\s*"
        Dim rg As New Regex(pattern)
            Dim m As Match = rg.Match(fn)
            If m.Success Then
                For Each g As Group In m.Groups
                    Debug.Print(g.Value)
                Next
            End If
            Debug.Print(m.Value)
        End Sub

    End Module
